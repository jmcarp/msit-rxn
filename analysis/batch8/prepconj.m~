function prepconj(infile1, infile2, outfile, varargin)

global CCN;

if nargin >= 4
    sign1 = varargin{4};
else
    sign1 = 1;
end

if nargin >= 5
    sign2 = varargin{5};
else
    sign2 = 1;
end

vol1 = spm_vol(infile1);
vol2 = spm_vol(infile2);
volout = vol1;
volout.fname = outfile;

img1 = spm_read_vols(vol1);
img2 = spm_read_vols(vol2);
imgout = nan(size(img1));
vox1 = sign(img1) == sign1;
vox2 = sign(img2) == sign2;
imgout(vox1) = 1;
imgout(vox2) = 2;
imgout(vox1 & vox2) = 3;

spm_write_vol(volout, imgout);

tempname = CCN.norm.hrtemp;
spm_reslice({tempname catname}, ...
    struct('mean', 0, 'which', 1));